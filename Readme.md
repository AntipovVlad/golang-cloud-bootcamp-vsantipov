# Тестовое задание

## Вопросы для разогрева
1. Наиболее интересной задачей для меня было расширение системы прав доступа в ERP Odoo, а именно добавление групп безопасности для каждой отдельной компании. Она возникла как необходимое условие при создании одного из функциональных модулей. Для этого мне пришлось глубоко погрузиться в исходный код, изучить, как она работает, составить полную схему взаимодействия всех уровней проверки, найти места, которые необходимо было модифицировать, не сломав при этом осной функционал системы. По итогу получилась гибкая система, которая пригодилась не только в рамках того модуля, но и в последующих.
2. В моей команде из трех человек одна коллега делала модуль, являвшийся архитектурным обновлением для одно из старых и стабильно работающих. Однако в момент, когда согласно дедлайну необходимо было уже вот-вот выпускать новую версию, она ушла в отпуск, толком ничего не протестировав, а второй коллега в это время болел. Под давлением начальства мне пришлось в срочном порядке чинить наиболее очевидные проблемы и выпускать в сыром виде. По итогу миграция прошла болезненно: хотя данные успешно были перенесены, функционал был не полностью доработан, а некоторые фичи были пропущены из-за того, что про них забыли. В течение 2 недель мне пришлось одному чинить все в срочном порядке, и хотя спустя это время пользователи смогли спокойно пользоваться новой версией, начальство было не совсем довольно. В дальнейшем наша команда определила строгие правила выпуска обновлений, а к планированию дедлайнов начали подходить более комплексно.
3. Я ожидаю получить ценный опыт в разработке и проектировании сложных систем, взаимодействия с командой, а также перенять знания и умения старших коллег. После окончания стажировки я хочу попасть в штат и продолжить работу над продуктами, которыми пользуется множество людей.

## Разработка
Развертывание системы осуществляется следующим образом:
1. В файл .env добавляются необходимые значения для переменных
2. В файл servers.yaml указываются необходимые сервера (в рамках данного тестового задания нужно, чтобы порты были разные)
3. Выполнить команду `docker compose up --build -d`

В качестве алгоритма балансировки доступен только Round Robin, однако система позволяет гибко добавлять любые другие алгоритмы в виде структур, реализующих интерфейс `Balancer`.

### API пользователя

Базовый путь: http://localhost:8080

**Создание пользователя**
* URL: /user/create
* METHOS: POST

*Request*
```json
{
    "name": "user1"
}
```
*Response*
```json
{
    "name": "user1",
    "capacity": 5,
    "rate_per_sec": 1,
    "api_key": "2d3da4a0-2f9e-4e78-a1ba-35e9fdce9cbe"
}
```

**Получение информации о пользователе**
* URL: /user/tokens/profile
* METHOS: GET
* HEADERS:

    * Authorization: *token*

*Request*
```json
no data
```
*Response*
```json
{
    "name": "user1",
    "capacity": 5,
    "rate_per_sec": 1,
    "current_capacity": 5
}
```

**Изменение токенов**
* URL: /user/tokens/change
* METHOS: POST
* HEADERS:

    * Authorization: *token*

*Request*
```json
{
    "capacity": 10,
    "rate_per_sec": 2,
}
```
*Response*
```json
{
    "name": "user1",
    "capacity": 10,
    "rate_per_sec": 2,
    "current_capacity": 5
}
```

**Запрос на балансировщик**
* URL: /
* METHOS: GET
* HEADERS:

    * Authorization: *token*

*Response*
- **200 OK**, Server {host_name} answer
- **503 Service Unavailable**, No available servers
